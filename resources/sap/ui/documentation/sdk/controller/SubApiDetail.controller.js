/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/documentation/sdk/controller/BaseController","sap/ui/documentation/sdk/util/ToggleFullScreenHandler","sap/ui/documentation/sdk/model/formatter","sap/m/Image","sap/m/Label","sap/m/Link","sap/m/Text","sap/m/HBox","sap/m/ObjectAttribute","sap/m/ObjectStatus","sap/m/Popover","sap/m/library","sap/ui/core/library","sap/m/CustomListItem","sap/m/List","sap/ui/dom/includeStylesheet","sap/ui/dom/includeScript"],function(q,B,T,f,I,L,a,b,H,O,c,P,l,d,C,e,i,g){"use strict";var F=l.FlexWrap;var h=d.ValueState;return B.extend("sap.ui.documentation.sdk.controller.SubApiDetail",{NOT_AVAILABLE:'N/A',PUBLIC_GITHUB_FRAMEWORK_DOMAIN:'https://github.com/SAP/openui5/blob/master/src/',SECTION_MAP:{"properties":"controlProperties","fields":"properties","special settings":"specialsettings"},formatter:f,onInit:function(){this._objectPage=this.byId("apiDetailObjectPage");if(!window.hljs){i("resources/sap/ui/documentation/sdk/thirdparty/highlight.js/styles.css");g({url:"resources/sap/ui/documentation/sdk/thirdparty/highlight.js/highlight.js"});}},initiate:function(r){var j,k,m,o=function(t){return!t.borrowedFrom;};this._sTopicId=r.sTopicId;this._oModel=r.oModel;this._oControlData=this._oModel.getData();this._aApiIndex=r.aApiIndex;this._aAllowedMembers=r.aAllowedMembers;this._sEntityType=r.sEntityType;this._sEntityId=r.sEntityId!=="undefined"?r.sEntityId:undefined;this._oEntityData=r.oEntityData;this._oContainerController=r.oContainerController;this._oContainerView=r.oContainerView;this._oToggleFullScreenBtn=this.byId("toggleFullScreenBtn");this.getOwnerComponent=function(){return r.oOwnerComponent;};this._oRouter=this.getRouter();this._allProperties=this._oModel.getProperty("/ui5-metadata/properties");this._allAggregations=this._oModel.getProperty("/ui5-metadata/aggregations");this._allAssociations=this._oModel.getProperty("/ui5-metadata/associations");if(this._allProperties){this._selfProperties=this._allProperties.filter(o);j=this._selfProperties.length>0;this._oModel.setProperty("/bShowBorrowedProps",!j);this._oModel.setProperty("/bHasSelfProps",j);this._oModel.setProperty("/bHasBorrowedProps",this._allProperties.length>this._selfProperties.length);this._oModel.setProperty("/ui5-metadata/properties",j?this._selfProperties:this._allProperties);}if(this._allAggregations){this._selfAggregations=this._allAggregations.filter(o);k=this._selfAggregations.length>0;this._oModel.setProperty("/bShowBorrowedAggr",!k);this._oModel.setProperty("/bHasSelfAggr",k);this._oModel.setProperty("/bHasBorrowedAggr",this._allAggregations.length>this._selfAggregations.length);this._oModel.setProperty("/ui5-metadata/aggregations",k?this._selfAggregations:this._allAggregations);}if(this._allAssociations){this._selfAssociations=this._allAssociations.filter(o);m=this._selfAssociations.length>0;this._oModel.setProperty("/bShowBorrowedAssoc",!m);this._oModel.setProperty("/bHasSelfAssoc",m);this._oModel.setProperty("/bHasBorrowedAssoc",this._allAssociations.length>this._selfAssociations.length);this._oModel.setProperty("/ui5-metadata/associations",m?this._selfAssociations:this._allAssociations);}if(this._oModel.getProperty("/hasFAQ")){var s=this._oEntityData.lib,n=s.replace(/\./g,'/'),p=this._oEntityData.name.replace(s,"").replace(/^[.]/,"").replace(/\./g,'/')+".html";q.ajax({type:"GET",url:'./docs/api/'+n+'/demokit/faq/'+p,success:function(t){this._oModel.setProperty("/faqContent",t);}.bind(this)});}this.setModel(this._oModel);this._oEntityData.appComponent=this._oControlData.component||this.NOT_AVAILABLE;this._oEntityData.hasSample=this._oControlData.hasSample;this._oEntityData.sample=this._oControlData.hasSample?this._sTopicId:this.NOT_AVAILABLE;this._buildHeaderLayout(this._oControlData,this._oEntityData);setTimeout(function(){this._hljs();this._objectPage.attachEvent("subSectionEnteredViewPort",function(){if(this._sHljsDelayedCallID){clearTimeout(this._sHljsDelayedCallID);}this._sHljsDelayedCallID=setTimeout(function(){var $=this._objectPage.$().find("pre:not(.hljs)");if($.length>0&&window.hljs){$.addClass('hljs');document.querySelectorAll('pre').forEach(function(t){window.hljs.highlightBlock(t);});}}.bind(this),200);},this);setTimeout(function(){if(this._sEntityType){this.scrollToEntity(this._sEntityType,this._sEntityId);}setTimeout(function(){this._objectPage.attachEvent("_sectionChange",function(E){var S=E.getParameter("section"),t=E.getParameter("subSection");if(this._oNavigatingTo){if(this._oNavigatingTo===t){this._oNavigatingTo=null;}return;}this._modifyURL(S,t,false);},this);this._objectPage.attachEvent("navigate",function(E){var S=E.getParameter("section"),t=E.getParameter("subSection");this._oNavigatingTo=t;this._modifyURL(S,t,true);},this);}.bind(this),500);}.bind(this),1000);}.bind(this),0);this.searchResultsButtonVisibilitySwitch(this.byId("apiDetailBackToSearch"));this.appendPageTitle(this._oModel.getProperty("/displayName"));},onAfterRendering:function(){this.getView().attachBrowserEvent("click",this.onJSDocLinkClick,this);T.updateControl(this._oToggleFullScreenBtn,this._oContainerView,this._oContainerController);},onExit:function(){this.getView().detachBrowserEvent("click",this.onJSDocLinkClick,this);},onToggleFullScreen:function(E){T.updateMode(E,this._oContainerView,this._oContainerController);},onBorrowedPropCheckboxClick:function(E){var j=E.getParameter("selected");this._oModel.setProperty("/bShowBorrowedProps",j);this._oModel.setProperty("/ui5-metadata/properties",j?this._allProperties:this._selfProperties);},onBorrowedAggrCheckboxClick:function(E){var j=E.getParameter("selected");this._oModel.setProperty("/bShowBorrowedAggr",j);this._oModel.setProperty("/ui5-metadata/aggregations",j?this._allAggregations:this._selfAggregations);},onBorrowedAssocCheckboxClick:function(E){var j=E.getParameter("selected");this._oModel.setProperty("/bShowBorrowedAssoc",j);this._oModel.setProperty("/ui5-metadata/associations",j?this._allAssociations:this._selfAssociations);},onJSDocLinkClick:function(E){var o=E.target.classList,j=o.contains("sapUISDKExternalLink");if(j){this.onDisclaimerLinkPress(E);return;}},_modifyURL:function(s,S,j){var k=s.getTitle().toLowerCase(),m=(S&&S.getTitle()!=='Overview')?S.getTitle():'';if(Object.keys(this.SECTION_MAP).indexOf(k)>=0){k=this.SECTION_MAP[k];}this._oRouter.navToChangeUrlOnly({id:this._sTopicId,entityType:k,entityId:m},j);},_hljs:function(){if(window.hljs){document.querySelectorAll('pre').forEach(function(j){window.hljs.highlightBlock(j);});}},scrollToEntity:function(s,S){var j,k,o;if(!s){return;}s=s.toLowerCase();o=this.byId(s);if(!o){return;}if(S){S=S.toLowerCase();k=o.getSubSections();j=k.filter(function(m){return m.getTitle().toLowerCase()===S;});if(j.length){this._objectPage.scrollToSection(j[0].getId(),250);}}else{this._objectPage.scrollToSection(o.getId(),250);}},_scrollContentToTop:function(){if(this._objectPage&&this._objectPage.$().length>0){this._objectPage.getScrollDelegate().scrollTo(0,0);}},_getHeaderLayoutUtil:function(){if(!this._oHeaderLayoutUtil){var _=function(t,s,p){var r=new O({title:t,text:s}).addStyleClass("sapUiTinyMarginBottom");if(p){r.setCustomContent(p);}return r;},j=function(t,p){return new c({title:"Visibility",text:f.formatVisibility(t,p),state:h.Warning}).addStyleClass("sapUiTinyMarginBottom");},k=function(p){return new a(p||{});},m=function(p){return new b(p||{});},n=function(p){return new L(p||{});},o=function(p,A){var r=new H(p||{});if(A){r.addStyleClass("sapUiDocumentationHeaderNavLinks sapUiTinyMarginBottom");}return r;};this._oHeaderLayoutUtil={_getControlSampleBlock:function(p,E){return o({items:[n({design:"Bold",text:"Control Sample:"}),k({emphasized:true,text:E.sample,visible:!!E.hasSample,href:"entity/"+p.name}),m({text:E.sample,visible:!E.hasSample})]},true);},_getControlGithub:function(p,E){return o({items:[n({design:"Bold",text:"GitHub:"}),k({emphasized:true,text:p.resource,visible:true,href:this.PUBLIC_GITHUB_FRAMEWORK_DOMAIN+E.lib+'/src/'+p.resource})]},true);},_getDocumentationBlock:function(p,E){return o({items:[n({design:"Bold",text:"Documentation:"}),k({emphasized:true,text:p.docuLinkText,href:"topic/"+p.docuLink})]},true);},_getUXGuidelinesBlock:function(p){return o({items:[n({design:"Bold",text:"UX Guidelines:"}),k({emphasized:true,text:p.uxGuidelinesLinkText,href:p.uxGuidelinesLink,target:"_blank"}),new I({src:"./resources/sap/ui/documentation/sdk/images/link-sap.png",tooltip:"Information published on SAP site",press:this.onDisclaimerLinkPress})]},true);},_getExtendsBlock:function(p,E){return o({items:[n({text:"Extends:"}),k({text:p.extendsText,href:"api/"+p.extendsText,visible:p.isDerived}),m({text:p.extendsText,visible:!p.isDerived})]},true);},_getSubclassesBlock:function(p,E){var s=E.extendedBy||E.implementedBy,S;this._aSubClasses=s;if(s.length===1){S=k({text:s[0],href:"api/"+s[0]});}else{S=k({text:p.isClass?"View subclasses":"View implementations",press:this._openSubclassesImplementationsPopover.bind(this)});}return o({items:[n({text:p.isClass?"Known direct subclasses:":"Known direct implementations:"}),S]},true);},_getImplementsBlock:function(p,E){var r=[n({text:"Implements:"})];p.implementsParsed.forEach(function(s){r.push(k({text:s.name,href:"api/"+s.href}));});return o({items:r,wrap:F.Wrap},true).addStyleClass("sapUiDocumentationCommaList");},_getModuleBlock:function(p,E){return _("Module",p.module);},_getLibraryBlock:function(p,E){return _("Library",E.lib);},_getVisibilityBlock:function(p,E){var v=p.visibility,A=E.allowedFor;if(v==="restricted"&&A){return A.length>1?_("Visibility",v,k({text:"restricted to",press:this._openVisibilityPopover.bind(this,A)})):j(v,A);}else{return _("Visibility",v);}},_getAvailableSinceBlock:function(p,E){return _("Available since",p.sinceText);},_getApplicationComponentBlock:function(p,E){return _("Application Component",E.appComponent);}};}return this._oHeaderLayoutUtil;},_openSubclassesImplementationsPopover:function(E){var p=this._aSubClasses.map(function(j){return new C({content:[new a({text:j,href:"api/"+j}).addStyleClass("sapUiTinyMargin")]});}),o=this._addPopoverContent(p);o.openBy(E.getSource());},_openVisibilityPopover:function(A,E){var p=A.map(function(s){return new C({content:[new b({text:s}).addStyleClass("sapUiTinyMargin")]});}),o=this._addPopoverContent(p);o.openBy(E.getSource());},_addPopoverContent:function(j){var p=this._getPopover();if(p.getContent().length>0){p.destroyContent();}if(j&&j.length>0){var o=new e({items:j||[]});p.addContent(o);}return p;},_getPopover:function(){if(!this._oPopover){this._oPopover=new P({placement:"Bottom",showHeader:false});}return this._oPopover;},_buildHeaderLayout:function(o,E){var j=0,S=1,k=2,m=3,n=[[],[],[]],p=this._getHeaderLayoutUtil(),s=E.extendedBy||E.implementedBy||[],r=this.getModel("versionData").getProperty("/isOpenUI5"),t=[{creator:"_getControlSampleBlock",exists:o.isClass||o.isNamespace},{creator:"_getDocumentationBlock",exists:o.docuLink!==undefined},{creator:"_getControlGithub",exists:r&&o.resource&&E.lib},{creator:"_getUXGuidelinesBlock",exists:o.uxGuidelinesLink!==undefined},{creator:"_getExtendsBlock",exists:o.isClass},{creator:"_getSubclassesBlock",exists:s.length>0},{creator:"_getImplementsBlock",exists:o.hasImplementsData},{creator:"_getModuleBlock",exists:true},{creator:"_getLibraryBlock",exists:o.kind==="namespace"&&E.lib},{creator:"_getVisibilityBlock",exists:o.visibility},{creator:"_getAvailableSinceBlock",exists:true},{creator:"_getApplicationComponentBlock",exists:true}],u=function(){var v=0,w,G=function(v){if(v<=m){return j;}else if(v<=m*2){return S;}return k;};t.forEach(function(x){var y;if(x.exists){y=p[x.creator].call(this,o,E);w=G(++v);n[w].push(y);}},this);}.bind(this);u();n.forEach(function(v,w){var V=this.byId("headerColumn"+w);V.removeAllContent();if(v.length>0){V.setVisible(true);v.forEach(V.addContent,V);}},this);},onAnnotationsLinkPress:function(){this.scrollToEntity("annotations","Summary");},backToSearch:function(){this.onNavBack();}});});
