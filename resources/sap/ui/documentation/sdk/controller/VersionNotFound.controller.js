/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseController","sap/ui/thirdparty/jquery","sap/ui/thirdparty/URI","sap/m/library"],function(B,q,U,L){"use strict";return B.extend("sap.ui.documentation.sdk.controller.VersionNotFound",{onInit:function(){this._loadVersionInfo().then(this._onVersionInfo.bind(this)).catch(this._onError.bind(this));},onReadMore:function(){L.URLHelper.redirect("https://blogs.sap.com/2021/01/26/removing-outdated-ui5-versions-from-ui5-cdn/");},onHomePress:function(){L.URLHelper.redirect("/");},_onError:function(){var m=this.getView().byId("page");m.setBusy(false);m.setText(this._getLibraryResourceBundle().getText("NOT_FOUND_UNAVAILABLE_TEXT"));},_onVersionInfo:function(v){var m=this.getView().byId("page"),r=this.getView().byId("readMoreButton"),a=new RegExp("^([0-9]+)(?:\\.([0-9]+)(?:\\.([0-9]+))?)?(.+)?"),u=new U(document.location.href),s=u.segment(),V,b=false;m.setBusy(false);for(var i=0,l=s.length;i<l;i++){if(a.test(s[i])){V=s[i];break;}}b=this._isVersionRemoved(v,V);if(b){m.setText(this._getLibraryResourceBundle().getText("NOT_FOUND_REMOVED_TEXT"));r.setVisible(true);}else{r.setVisible(false);m.setText(this._getLibraryResourceBundle().getText("NOT_FOUND_UNAVAILABLE_TEXT"));}},_isVersionRemoved:function(v,V){var p=v.patches,i,r;i=p.findIndex(function(d){r=new RegExp(d.version);return d.removed&&r.test(V);});return i>-1;},_getLibraryResourceBundle:function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.documentation");},_loadVersionInfo:function(){return new Promise(function(r,a){q.ajax({async:true,url:"/versionoverview.json",dataType:'json',success:function(R){r(R);},error:function(e){a(e);}});});}});});
