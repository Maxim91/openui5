/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Fragment","sap/ui/fl/write/api/Version","sap/ui/rta/toolbar/translation/Translation","sap/ui/rta/toolbar/versioning/Versioning","sap/ui/rta/appVariant/Feature","sap/ui/rta/toolbar/Base","sap/ui/Device"],function(F,V,T,a,A,B,D){"use strict";var b=B.extend("sap.ui.rta.toolbar.Adaptation",{renderer:"sap.ui.rta.toolbar.AdaptationRenderer",animation:true,metadata:{library:"sap.ui.rta",events:{undo:{},redo:{},exit:{},save:{},restore:{},transport:{},publishVersion:{},modeChange:{},activate:{},discardDraft:{},switchVersion:{},openChangeCategorySelectionPopover:{}}}});b.modes={MOBILE:"sapUiRtaToolbarMobile",TABLET:"sapUiRtaToolbarTablet",DESKTOP:"sapUiRtaToolbarDesktop"};var c="sapUiRtaToolbar";b.prototype.init=function(){this._pFragmentLoaded=B.prototype.init.apply(this,arguments).then(function(){if(!D.media.hasRangeSet(c)){D.media.initRangeSet(c,[900,1200],"px",[b.modes.MOBILE,b.modes.TABLET,b.modes.DESKTOP]);}D.media.attachHandler(this._onSizeChanged,this,c);}.bind(this));};b.prototype.onFragmentLoaded=function(){return this._pFragmentLoaded;};b.prototype.exit=function(){D.media.detachHandler(this._onSizeChanged,this,c);B.prototype.exit.apply(this,arguments);};b.prototype.show=function(){this._onSizeChanged(D.media.getCurrentRange(c),true);return B.prototype.show.apply(this,arguments);};function s(i,I,t,j){var k=this.getControl(i);var l=t?this.getTextResources().getText(t):"";var m=j?this.getTextResources().getText(j):"";k.setText(l||"");k.setTooltip(m||"");k.setIcon(I||"");}b.prototype.formatPublishVersionVisibility=function(p,v,i,m){return this.getExtension("versioning",a).formatPublishVersionVisibility(p,v,i,m);};b.prototype.formatDiscardDraftVisible=function(i,v,m){return this.getExtension("versioning",a).formatDiscardDraftVisible(i,v,m);};b.prototype.formatVersionButtonText=function(v,i){return this.getExtension("versioning",a).formatVersionButtonText(v,i);};b.prototype.showVersionHistory=function(E){return this.getExtension("versioning",a).showVersionHistory(E);};b.prototype._openVersionTitleDialog=function(i){return this.getExtension("versioning",a).openActivateVersionDialog(i);};b.prototype.showRestore=function(v){return!v;};b.prototype._showButtonIcon=function(i,I,t){s.call(this,i,I,"",t);};b.prototype._showButtonText=function(i,t){s.call(this,i,"",t,"");};b.prototype._switchToIcons=function(){var i=this.getControl("iconBox");var I=this.getControl("iconSpacer");i.setVisible(false);I.setVisible(false);this._showButtonIcon("adaptationSwitcherButton","sap-icon://wrench","BTN_ADAPTATION");this._showButtonIcon("navigationSwitcherButton","sap-icon://explorer","BTN_NAVIGATION");this._showButtonIcon("visualizationSwitcherButton","sap-icon://show","BTN_VISUALIZATION");this._showButtonIcon("exit","sap-icon://decline","BTN_EXIT");};b.prototype._switchToTexts=function(){var i=this.getControl("iconBox");var I=this.getControl("iconSpacer");i.setVisible(true);I.setVisible(true);this._showButtonText("adaptationSwitcherButton","BTN_ADAPTATION");this._showButtonText("navigationSwitcherButton","BTN_NAVIGATION");this._showButtonText("visualizationSwitcherButton","BTN_VISUALIZATION");this._showButtonText("exit","BTN_EXIT");};b.prototype._onSizeChanged=function(p,i){if(p){var m=p.name;this.sMode=m;switch(m){case b.modes.MOBILE:this._switchToIcons();break;case b.modes.TABLET:case b.modes.DESKTOP:if(!i){this._switchToTexts();}break;default:}}};b.prototype.buildControls=function(){return F.load({name:"sap.ui.rta.toolbar.Adaptation",id:this.getId()+"_fragment",controller:{activate:this._openVersionTitleDialog.bind(this),discardDraft:this.eventHandler.bind(this,"DiscardDraft"),formatDiscardDraftVisible:this.formatDiscardDraftVisible.bind(this),formatPublishVersionVisibility:this.formatPublishVersionVisibility.bind(this),modeChange:this.eventHandler.bind(this,"ModeChange"),openDownloadTranslationDialog:o.bind(this),openUploadTranslationDialog:d.bind(this),undo:this.eventHandler.bind(this,"Undo"),redo:this.eventHandler.bind(this,"Redo"),openChangeCategorySelectionPopover:this.eventHandler.bind(this,"OpenChangeCategorySelectionPopover"),manageApps:h.bind(this),appVariantOverview:g.bind(this),saveAs:e.bind(this),formatSaveAsEnabled:f,restore:this.eventHandler.bind(this,"Restore"),publish:this.eventHandler.bind(this,"Transport"),publishVersion:this.eventHandler.bind(this,"PublishVersion"),exit:this.eventHandler.bind(this,"Exit"),formatVersionButtonText:this.formatVersionButtonText.bind(this),showVersionHistory:this.showVersionHistory.bind(this),showRestore:this.showRestore.bind(this)}});};function o(){var p={layer:this.getRtaInformation().flexSettings.layer,selector:this.getRtaInformation().rootControl};this.getExtension("translation",T).openDownloadTranslationDialog(p);}function d(){this.getExtension("translation",T).openUploadTranslationDialog();}function f(G,i){return G&&i!==V.Number.Draft;}function e(){A.onSaveAs(true,true,this.getRtaInformation().flexSettings.layer,null);}function g(E){var i=E.getParameter("item");var t=i.getId().endsWith("keyUser");return A.onGetOverview(t,this.getRtaInformation().flexSettings.layer);}function h(){A.onGetOverview(true,this.getRtaInformation().flexSettings.layer);}b.prototype.getControl=function(n){return sap.ui.getCore().byId(this.getId()+"_fragment--sapUiRta_"+n);};return b;});
