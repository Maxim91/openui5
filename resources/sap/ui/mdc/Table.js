/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Control","./ActionToolbar","./table/TableSettings","./table/GridTableType","./table/ResponsiveTableType","./table/PropertyHelper","./mixin/FilterIntegrationMixin","./library","sap/m/Text","sap/m/Title","sap/m/ColumnHeaderPopover","sap/m/ColumnPopoverSelectListItem","sap/m/ColumnPopoverActionItem","sap/m/OverflowToolbar","sap/m/library","sap/m/table/columnmenu/Menu","sap/ui/core/Core","sap/ui/core/format/NumberFormat","sap/ui/core/dnd/DragDropInfo","sap/ui/core/Item","sap/ui/core/format/ListFormat","sap/ui/core/library","sap/ui/events/KeyCodes","sap/ui/model/Sorter","sap/base/strings/capitalize","sap/base/util/deepEqual","sap/base/util/Deferred","sap/base/util/UriParameters","sap/ui/core/InvisibleMessage","sap/ui/core/InvisibleText","sap/ui/mdc/p13n/subcontroller/ColumnController","sap/ui/mdc/p13n/subcontroller/SortController","sap/ui/mdc/p13n/subcontroller/FilterController","sap/ui/mdc/p13n/subcontroller/GroupController","sap/ui/mdc/p13n/subcontroller/AggregateController","sap/ui/mdc/p13n/subcontroller/ColumnWidthController","sap/ui/mdc/actiontoolbar/ActionToolbarAction","sap/ui/mdc/table/RowActionItem","sap/ui/mdc/table/RowSettings","sap/ui/mdc/table/menu/QuickActionContainer","sap/ui/mdc/table/menu/ItemContainer","sap/ui/base/ManagedObjectMetadata"],function(C,A,T,G,R,P,F,l,a,b,c,d,e,O,M,f,g,N,D,I,L,h,K,S,i,j,k,U,m,n,o,p,q,r,s,t,u,v,w,Q,x,y){"use strict";var z=l.SelectionMode;var B=l.TableType;var E=l.TableP13nMode;var H=M.ToolbarDesign;var J=M.ToolbarStyle;var V=l.MultiSelectMode;var W=h.TitleLevel;var X=h.SortOrder;var Y=new window.WeakMap();var Z=function(p1){if(!Y.has(p1)){Y.set(p1,{oFilterInfoBar:null});}return Y.get(p1);};function $(p1,q1){sap.ui.require(["sap/m/MessageToast"],function(r1){var s1=g.getLibraryResourceBundle("sap.ui.mdc");r1.show(s1.getText(p1,q1));});}var _=C.extend("sap.ui.mdc.Table",{metadata:{library:"sap.ui.mdc",designtime:"sap/ui/mdc/designtime/table/Table.designtime",interfaces:["sap.ui.mdc.IFilterSource","sap.ui.mdc.IxState"],defaultAggregation:"columns",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null,invalidate:true},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null,invalidate:true},p13nMode:{type:"sap.ui.mdc.TableP13nMode[]",defaultValue:[]},delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/TableDelegate",payload:{}}},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:W.Auto},autoBindOnInit:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.ui.mdc.SelectionMode",defaultValue:z.None},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},threshold:{type:"int",group:"Appearance",defaultValue:-1},noDataText:{type:"string"},sortConditions:{type:"object"},filterConditions:{type:"object",defaultValue:{}},groupConditions:{type:"object"},aggregateConditions:{type:"object"},enableExport:{type:"boolean",defaultValue:false},busyIndicatorDelay:{type:"int",defaultValue:100},enableColumnResize:{type:"boolean",group:"Behavior",defaultValue:true},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true},multiSelectMode:{type:"sap.ui.mdc.MultiSelectMode",group:"Behavior",defaultValue:V.Default},enableAutoColumnWidth:{type:"boolean",group:"Behavior",defaultValue:false}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},type:{type:"sap.ui.mdc.table.TableTypeBase",altTypes:["sap.ui.mdc.TableType"],multiple:false},columns:{type:"sap.ui.mdc.table.Column",multiple:true},creationRow:{type:"sap.ui.mdc.table.CreationRow",multiple:false},actions:{type:"sap.ui.core.Control",multiple:true,forwarding:{getter:"_createToolbar",aggregation:"actions"}},variant:{type:"sap.ui.fl.variants.VariantManagement",multiple:false},quickFilter:{type:"sap.ui.core.Control",multiple:false},rowSettings:{type:"sap.ui.mdc.table.RowSettings",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false}},associations:{filter:{type:"sap.ui.mdc.IFilter",multiple:false}},events:{rowPress:{parameters:{bindingContext:{type:"sap.ui.model.Context"}}},selectionChange:{parameters:{bindingContext:{type:"sap.ui.model.Context"},selected:{type:"boolean"},selectAll:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"}}},paste:{parameters:{data:{type:"string[][]"}}}}},constructor:function(){this._oTableReady=new k();this._oFullInitialize=new k();this._bUseColumnMenu=U.fromQuery(window.location.search).get("sap-ui-xx-columnmenu")==="true";C.apply(this,arguments);this.bCreated=true;this._doOneTimeOperations();this._initializeContent();},renderer:{apiVersion:2,render:function(p1,q1){p1.openStart("div",q1);p1.class("sapUiMdcTable");p1.style("height",q1.getHeight());p1.style("width",q1.getWidth());p1.openEnd();p1.renderControl(q1.getAggregation("_content"));p1.close("div");}}});var a1=["variant","quickFilter"];F.call(_.prototype);a1.forEach(function(p1){var q1=i(p1),r1="_o"+q1,s1="get"+q1,t1="set"+q1,u1="destroy"+q1;_.prototype[s1]=function(){return this[r1];};_.prototype[u1]=function(){var v1=this[r1];this[t1]();if(v1){v1.destroy();}return this;};_.prototype[t1]=function(v1){this.validateAggregation(p1,v1,false);var w1=this._createToolbar(),x1=v1!==this[r1];if(!v1||x1){w1.removeBetween((this[s1]()));this[r1]=v1;}if(x1&&v1){this._setToolbarBetween(w1);}return this;};});_.prototype.init=function(){C.prototype.init.apply(this,arguments);this.mSkipPropagation={rowSettings:true};this._bForceRebind=true;this._aSupportedP13nModes=Object.keys(E);this._updateAdaptation();};_.prototype.applySettings=function(){this._setPropertyHelperClass(P);C.prototype.applySettings.apply(this,arguments);this.initControlDelegate();};_.prototype._setToolbarBetween=function(p1){[this._oVariant,this._oQuickFilter].forEach(function(q1){if(q1){p1.addBetween(q1);}});};_.prototype.initialized=function(){return this._oTableReady.promise;};_.prototype._fullyInitialized=function(){return this._oFullInitialize.promise;};_.prototype.getDataStateIndicatorPluginOwner=function(p1){return this._oTable||this._oFullInitialize.promise;};_.prototype.setDataStateIndicator=function(p1){this._handleDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",p1,true);this._handleDataStateEvents(this.getDataStateIndicator(),"attach");return this;};_.prototype._handleDataStateEvents=function(p1,q1){if(p1){p1[q1+"ApplyFilter"](this._onApplyMessageFilter,this);p1[q1+"ClearFilter"](this._onClearMessageFilter,this);p1[q1+"Event"]("filterInfoPress",o1,this);}};_.prototype._onApplyMessageFilter=function(p1){this._oMessageFilter=p1.getParameter("filter");p1.preventDefault();this._rebind();};_.prototype._onClearMessageFilter=function(p1){this._oMessageFilter=null;p1.preventDefault();this._rebind();};_.prototype._getStringType=function(p1){var q1,r1=q1=p1||this.getType();if(!r1){q1=B.Table;}else if(typeof r1==="object"){if(r1.isA("sap.ui.mdc.table.ResponsiveTableType")){q1=B.ResponsiveTable;}else{q1=B.Table;}}return q1;};_.prototype._isOfType=function(p1){return this._getStringType()===p1;};_.prototype._updateTypeSettings=function(){var p1=this.getType();if(p1&&typeof p1==="object"){p1.updateTableSettings();}else{if(p1==="ResponsiveTable"){p1=R;}else{p1=G;}p1.updateDefault(this._oTable);}};_.prototype.scrollToIndex=function(p1){return new Promise(function(q1,r1){if(!this._oTable){return r1();}if(typeof p1!=="number"){return r1("The iIndex parameter has to be a number");}if(this._isOfType(B.ResponsiveTable)){this._oTable.scrollToIndex(p1).then(q1).catch(r1);}else{if(p1===-1){p1=this._getRowCount(false);}if(this._oTable._setFirstVisibleRowIndex(p1)){this._oTable.attachEventOnce("rowsUpdated",function(){q1();});}else{q1();}}}.bind(this));};_.prototype.focusRow=function(p1,q1){return this.scrollToIndex(p1).then(function(){return this._oTable._setFocus(p1,q1);}.bind(this));};_.prototype.setType=function(p1){var q1=this._getStringType(p1);var r1=this._getStringType();this.setAggregation("type",p1,true);if(q1===r1&&this._oTable){this._updateTypeSettings();return this;}if(this.bCreated){if(this._oTable){if(r1==="ResponsiveTable"){this._oTable.setHeaderToolbar();}else{this._oTable.removeExtension(this._oToolbar);}this._oTable.destroy("KeepDom");this._oTable=null;this._bTableExists=false;}else{this._onAfterTableCreated();this._onAfterFullInitialization();}if(this._oTemplate){this._oTemplate.destroy();this._oTemplate=null;}this._oTableReady=new k();this._oFullInitialize=new k();this._bFullyInitialized=false;this._initializeContent();}return this;};_.prototype.setRowSettings=function(p1){this.setAggregation("rowSettings",p1,true);if(this._oTable){this._oRowActions={};if(this._isOfType(B.ResponsiveTable)){R.updateRowSettings(this,p1,this._onResponsiveRowActionPress);}else{G.updateRowSettings(this._oTable,p1,[this._onRowActionPress,this]);}this._bForceRebind=true;this._rebind();}return this;};_.prototype.setHeaderLevel=function(p1){if(this.getHeaderLevel()===p1){return this;}this.setProperty("headerLevel",p1,true);this._oTitle&&this._oTitle.setLevel(p1);return this;};_.prototype.focus=function(p1){if(this._oTable){this._oTable.focus(p1);}};_.prototype.setBusy=function(p1){this.setProperty('busy',p1,true);if(this._oTable){this._oTable.setBusy(p1);}return this;};_.prototype.setBusyIndicatorDelay=function(p1){this.setProperty('busyIndicatorDelay',p1,true);if(this._oTable){this._oTable.setBusyIndicatorDelay(p1);}return this;};_.prototype.setSelectionMode=function(p1){var q1=this.getSelectionMode();this.setProperty("selectionMode",p1,true);if(this._oTable&&q1!=this.getSelectionMode()){this._updateSelectionBehavior();}return this;};_.prototype.setMultiSelectMode=function(p1){var q1=this.getMultiSelectMode();this.setProperty("multiSelectMode",p1,true);if(this._oTable&&q1!=this.getMultiSelectMode()){this._updateMultiSelectMode();}return this;};_.prototype.setCreationRow=function(p1){this.setAggregation("creationRow",p1,true);if(p1){p1.update();}return this;};_.prototype.setEnableColumnResize=function(p1){var q1=this.getEnableColumnResize();this.setProperty("enableColumnResize",p1,true);if(this.getEnableColumnResize()!==q1){this._updateColumnResizer();this._updateAdaptation();}return this;};_.prototype._onModifications=function(){this.getColumns().forEach(function(p1){p1._onModifications();});};_.prototype.setP13nMode=function(p1){var q1=this.getP13nMode();var r1=[];if(p1&&p1.length>1){var s1=p1.reduce(function(t1,u1,v1){t1[u1]=true;return t1;},{});if(s1.Column){r1.push("Column");}if(s1.Sort){r1.push("Sort");}if(s1.Filter){r1.push("Filter");}if(s1.Group){r1.push("Group");}if(s1.Aggregate){r1.push("Aggregate");}}else{r1=p1;}this.setProperty("p13nMode",r1,true);this._updateAdaptation();if(!j(q1.sort(),this.getP13nMode().sort())){b1(this);}return this;};_.prototype._updateAdaptation=function(){var p1={controller:{}};var q1={Column:o,Sort:p,Group:r,Filter:q,Aggregate:s,ColumnWidth:t};this.getActiveP13nModes().forEach(function(r1){p1.controller[r1]=q1[r1];});if(this.getEnableColumnResize()){p1.controller["ColumnWidth"]=q1["ColumnWidth"];}this.getEngine().registerAdaptation(this,p1);};function b1(p1){if(p1._oToolbar){p1._oToolbar.destroyEnd();p1._getP13nButtons().forEach(function(r1){p1._oToolbar.addEnd(r1);});}if(p1._oTable){var q1=p1._oTable.getDragDropConfig()[0];if(q1){q1.setEnabled(p1.getActiveP13nModes().indexOf("Column")>-1);}}if(p1.isFilteringEnabled()){d1(p1);}c1(p1);}_.prototype.setFilterConditions=function(p1){this.setProperty("filterConditions",p1,true);var q1=this.getInbuiltFilter();if(q1){q1.setFilterConditions(p1);}c1(this);return this;};function c1(p1){var q1=g1(p1);var r1=h1(p1);var s1=i1(p1);if(!q1){return;}if(s1.length===0){var t1=q1.getDomRef();if(t1&&t1.contains(document.activeElement)){p1.focus();}q1.setVisible(false);e1(p1).setText("");return;}p1._fullyInitialized().then(function(){var u1=p1.getPropertyHelper();var v1=s1.map(function(z1){return u1.hasProperty(z1)?u1.getProperty(z1).label:"";});var w1=g.getLibraryResourceBundle("sap.ui.mdc");var x1=L.getInstance();var y1=w1.getText("table.FILTER_INFO",x1.format(v1));if(!q1.getVisible()){q1.setVisible(true);}r1.setText(y1);e1(p1).setText(y1);});}function d1(p1){if(!p1._oTable){return;}var q1=g1(p1);if(!q1){q1=f1(p1);}if(p1._bMobileTable){if(p1._oTable.getInfoToolbar()!==q1){p1._oTable.setInfoToolbar(q1);}}else if(p1._oTable.indexOfExtension(q1)===-1){p1._oTable.insertExtension(q1,1);}var r1=e1(p1);p1._oTable.addAriaLabelledBy(r1.getId());}function e1(p1){if(!p1){return null;}if(!p1._oFilterInfoBarInvisibleText){p1._oFilterInfoBarInvisibleText=new n().toStatic();}return p1._oFilterInfoBarInvisibleText;}function f1(p1){var q1=p1.getId()+"-filterInfoBar";var r1=Z(p1).oFilterInfoBar;if(r1&&!r1.bIsDestroyed){r1.destroy();}r1=new O({id:q1,active:true,design:H.Info,visible:false,content:[new a({id:q1+"-text",wrapping:false})],press:[o1,p1]});r1.focus=function(){if(this.getDomRef()){O.prototype.focus.apply(this,arguments);}else{p1.focus();}};Z(p1).oFilterInfoBar=r1;c1(p1);return r1;}function g1(p1){var q1=Z(p1).oFilterInfoBar;if(q1&&(q1.bIsDestroyed||q1.bIsBeingDestroyed)){return null;}return Z(p1).oFilterInfoBar;}function h1(p1){var q1=g1(p1);return q1?q1.getContent()[0]:null;}_.prototype.setThreshold=function(p1){this.setProperty("threshold",p1,true);if(!this._oTable){return this;}p1=this.getThreshold()>-1?this.getThreshold():undefined;if(this._bMobileTable){this._oTable.setGrowingThreshold(p1);}else{this._oTable.setThreshold(p1);}return this;};_.prototype._onFilterProvided=function(p1){this._updateInnerTableNoDataText();};_.prototype._onFilterRemoved=function(p1){this._updateInnerTableNoDataText();};_.prototype._onFiltersChanged=function(p1){if(this.isTableBound()&&p1.getParameter("conditionsBased")){this._oTable.setShowOverlay(true);}};_.prototype._onFilterSearch=function(p1){this._bIgnoreChange=true;this._bAnnounceTableUpdate=true;};_.prototype.setNoDataText=function(p1){this.setProperty("noDataText",p1,true);this._updateInnerTableNoDataText();return this;};_.prototype._updateInnerTableNoDataText=function(){if(!this._oTable){return;}var p1=this._getNoDataText();if(this._bMobileTable){this._oTable.setNoDataText(p1);}else{this._oTable.setNoData(p1);}};_.prototype._getNoDataText=function(){var p1=this.getNoDataText();if(p1){return p1;}var q1=g.getLibraryResourceBundle("sap.ui.mdc");if(!this.isTableBound()){if(this.getFilter()){return q1.getText("table.NO_DATA_WITH_FILTERBAR");}return q1.getText("table.NO_DATA");}if(k1(this)){return q1.getText("table.NO_RESULTS");}return q1.getText("table.NO_DATA");};_.prototype._updateRowAction=function(){if(!this._oTable){return;}var p1=this._bMobileTable?R:G;p1.updateRowActions(this,this.getRowSettings(),this._bMobileTable?this._onResponsiveRowActionPress:this._onRowActionPress);};_.prototype._initializeContent=function(){var p1,q1=this._getStringType();if(this._isOfType(B.ResponsiveTable)){p1=R;}else{p1=G;}var r1=[this.awaitControlDelegate(),p1.loadTableModules()];if(this.isFilteringEnabled()){r1.push(this.retrieveInbuiltFilter());}Promise.all(r1).then(function(){if(this.bIsDestroyed){return;}var s1=this.getControlDelegate();this._aSupportedP13nModes=s1.getSupportedP13nModes(this);this._updateAdaptation();if(s1.preInit){this._pDelegatePreInit=s1.preInit(this);}if(!this._bTableExists&&q1===this._getStringType()){this._bMobileTable=q1==="ResponsiveTable";this._createContent();this._bTableExists=true;}}.bind(this)).catch(function(s1){this._onAfterTableCreated();throw s1;}.bind(this));};_.prototype._doOneTimeOperations=function(){if(!this.bColumnsOrdered){this.bColumnsOrdered=true;this._orderColumns();}};_.prototype._onAfterTableCreated=function(p1){this._oTableReady[p1?"resolve":"reject"](this);};_.prototype._onAfterFullInitialization=function(p1){this._oFullInitialize[p1?"resolve":"reject"](this);};_.prototype._createContent=function(){this._createToolbar();this._createTable();this._updateColumnResizer();this._updateRowAction();this.getColumns().forEach(this._insertInnerColumn,this);this.setAggregation("_content",this._oTable);this._onAfterTableCreated(true);var p1=this.initialized().then(function(){this.initPropertyHelper();var q1=this.getCreationRow();if(q1){q1.update();}if(this.getAutoBindOnInit()){this.rebind();}return this.awaitPropertyHelper();}.bind(this));Promise.all([p1,this._pDelegatePreInit]).then(function(){delete this._pDelegatePreInit;this._bFullyInitialized=true;this._onAfterFullInitialization(true);}.bind(this)).catch(function(q1){this._onAfterFullInitialization();throw q1;}.bind(this));};_.prototype.setHeader=function(p1){this.setProperty("header",p1,true);this._updateHeaderText();this._updateExportState(true);return this;};_.prototype.setHeaderVisible=function(p1){this.setProperty("headerVisible",p1,true);if(this._oTitle){this._oTitle.setWidth(this.getHeaderVisible()?undefined:"0px");}return this;};_.prototype.setShowRowCount=function(p1){this.setProperty("showRowCount",p1,true);this._updateHeaderText();return this;};_.prototype.setEnableExport=function(p1){if(p1!==this.getEnableExport()){this.setProperty("enableExport",p1,true);if(p1&&!this._oExportButton&&this._oToolbar){this._oToolbar.addEnd(this._getExportButton());}else if(this._oExportButton){this._oExportButton.setVisible(p1);}}return this;};_.prototype.setShowPasteButton=function(p1){if((p1=!!p1)==this.getShowPasteButton()){return this;}this.setProperty("showPasteButton",p1,true);if(p1&&!this._oPasteButton&&this._oToolbar){this._oToolbar.insertEnd(this._getPasteButton(),0);this._oPasteButton.setEnabled(this.getEnablePaste());}else if(this._oPasteButton){this._oPasteButton.setVisible(p1);this._oPasteButton.setEnabled(this.getEnablePaste());}return this;};_.prototype.setEnablePaste=function(p1){this.setProperty("enablePaste",p1,true);if(this._oPasteButton){this._oPasteButton.setEnabled(this.getEnablePaste());}return this;};_.prototype._createToolbar=function(){if(this.isDestroyStarted()||this.isDestroyed()){return;}if(!this._oToolbar){this._oTitle=new b(this.getId()+"-title",{text:this.getHeader(),width:this.getHeaderVisible()?undefined:"0px",level:this.getHeaderLevel()});this._oToolbar=new A(this.getId()+"-toolbar",{design:H.Transparent,begin:[this._oTitle],end:[this._getPasteButton(),this._getP13nButtons(),this._getExportButton()]});}this._oToolbar.setStyle(this._bMobileTable?J.Standard:J.Clear);return this._oToolbar;};_.prototype._getVisibleProperties=function(){var p1=[],q1;this.getColumns().forEach(function(r1,s1){q1=r1&&r1.getDataProperty();if(q1){p1.push({name:q1});}});return p1;};_.prototype.getConditions=function(){return this.getInbuiltFilter()?this.getInbuiltFilter().getConditions():[];};_.prototype._getSortedProperties=function(){return this.getSortConditions()?this.getSortConditions().sorters:[];};_.prototype._getGroupedProperties=function(){return this.getGroupConditions()?this.getGroupConditions().groupLevels:[];};_.prototype._getAggregatedProperties=function(){return this.getAggregateConditions()?this.getAggregateConditions():{};};_.prototype._getXConfig=function(){return this.getEngine().readXConfig(this);};function i1(p1){return p1.isFilteringEnabled()?l1(p1.getFilterConditions()):[];}function j1(p1){var q1=g.byId(p1.getFilter());return q1?l1(q1.getConditions()):[];}function k1(p1){var q1=g.byId(p1.getFilter());return i1(p1).length>0||j1(p1).length>0||q1&&q1.getSearch()!=="";}function l1(p1){return Object.keys(p1||{}).filter(function(q1){return p1[q1].length>0;});}_.prototype.getCurrentState=function(){var p1={};var q1=this.getActiveP13nModes();if(q1.indexOf("Column")>-1){p1.items=this._getVisibleProperties();}if(this.isSortingEnabled()){p1.sorters=this._getSortedProperties();}if(this.isFilteringEnabled()){p1.filter=this.getFilterConditions();}if(this.isGroupingEnabled()){p1.groupLevels=this._getGroupedProperties();}if(this.isAggregationEnabled()){p1.aggregations=this._getAggregatedProperties();}if(this.getEnableColumnResize()){p1.xConfig=this._getXConfig();}return p1;};_.prototype.isFilteringEnabled=function(){return this.getActiveP13nModes().includes(E.Filter);};_.prototype.isSortingEnabled=function(){return this.getActiveP13nModes().includes(E.Sort);};_.prototype.isGroupingEnabled=function(){return this.getActiveP13nModes().includes(E.Group);};_.prototype.isAggregationEnabled=function(){return this.getActiveP13nModes().includes(E.Aggregate);};_.prototype.getSupportedP13nModes=function(){return this._aSupportedP13nModes||[];};_.prototype.getActiveP13nModes=function(){var p1=this.getP13nMode();var q1=this.getSupportedP13nModes();p1=p1.filter(function(r1){return q1.includes(r1);});return p1;};_.prototype._getP13nButtons=function(){var p1=this.getActiveP13nModes();var q1=[];var r1=p1.length===1&&p1[0]==="Aggregate";if(p1.length>0&&!r1){q1.push(T.createSettingsButton(this.getId(),[n1,this]));}return q1;};_.prototype._getPasteButton=function(){if(this.getShowPasteButton()){if(!this._oPasteButton){this._oPasteButton=T.createPasteButton(this.getId());}return this._oPasteButton;}};_.prototype._getExportButton=function(){if(!this.getEnableExport()){return null;}if(!this._oExportButton){this._oExportButton=T.createExportButton(this.getId(),{"default":[function(){this._onExport();},this],"exportAs":[function(){this._onExport(true);},this]});}this._updateExportState();return this._oExportButton;};_.prototype._updateExportState=function(p1){if(this._oExportButton){this._oExportButton.setEnabled(this._getRowCount(false)>0);if(p1&&this._cachedExportSettings){this._cachedExportSettings.fileName=this.getHeader();}}};_.prototype._createExportColumnConfiguration=function(){var p1=this.getColumns();return this._fullyInitialized().then(function(){var q1=this.getPropertyHelper();var r1=[];p1.forEach(function(s1){var t1=q1.getColumnExportSettings(s1);r1=r1.concat(t1);},this);return r1;}.bind(this));};_.prototype._getColumnLabel=function(p1){var q1=this.getPropertyHelper();var r1=q1.getProperty(p1);return r1&&r1.label;};_.prototype._onExport=function(p1){var q1=this;return this._createExportColumnConfiguration().then(function(r1){if(!r1||!r1.length){sap.ui.require(["sap/m/MessageBox"],function(v1){v1.error(g.getLibraryResourceBundle("sap.ui.mdc").getText("table.NO_COLS_EXPORT"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});}.bind(q1));return;}var s1=q1._getRowBinding();var t1=q1._getColumnLabel.bind(q1);var u1={workbook:{columns:r1,context:{title:q1.getHeader()}},dataSource:s1,fileName:q1.getHeader()};q1._loadExportLibrary().then(function(){sap.ui.require(["sap/ui/export/ExportHandler"],function(v1){var w1;q1.getControlDelegate().fetchExportCapabilities(q1).then(function(x1){if(!q1._oExportHandler){w1=new v1(x1);w1.attachBeforeExport(function(y1){q1.fireBeforeExport({exportSettings:y1.getParameter('exportSettings'),userExportSettings:y1.getParameter('userExportSettings')});});q1._oExportHandler=w1;}if(p1){q1._oExportHandler.exportAs(u1,t1);}else{q1._oExportHandler.export(u1,t1);}});});});});};_.prototype._loadExportLibrary=function(){if(!this._oExportLibLoadPromise){this._oExportLibLoadPromise=g.loadLibrary("sap.ui.export",true);}return this._oExportLibLoadPromise;};_.prototype.onkeydown=function(p1){if(p1.isMarked()){return;}if((p1.metaKey||p1.ctrlKey)&&p1.shiftKey&&p1.which===K.E){if(this.getEnableExport()&&this._oExportButton&&this._oExportButton.getEnabled()){this._onExport(true);p1.setMarked();p1.preventDefault();}}if((p1.metaKey||p1.ctrlKey)&&p1.which===K.COMMA){var q1=g.byId(this.getId()+"-settings");if(q1&&q1.getEnabled()&&q1.getVisible()){q1.firePress();p1.setMarked();p1.preventDefault();}}};_.prototype._createTable=function(){var p1=this.getThreshold()>-1?this.getThreshold():undefined;var q1=this.getRowSettings()?this.getRowSettings().getAllSettings():{};if(this._bMobileTable){this._oTable=R.createTable(this.getId()+"-innerTable",{autoPopinMode:true,contextualWidth:"Auto",growing:true,sticky:["ColumnHeaders","HeaderToolbar","InfoToolbar"],itemPress:[this._onItemPress,this],selectionChange:[this._onSelectionChange,this],growingThreshold:p1,noDataText:this._getNoDataText(),headerToolbar:this._oToolbar,ariaLabelledBy:[this._oTitle]});this._oTemplate=R.createTemplate(this.getId()+"-innerTableRow",q1);this._sAggregation="items";this._oTable.bindRows=this._oTable.bindItems;this._oTable.bActiveHeaders=true;this._oTable.attachEvent("columnPress",this._onResponsiveTableColumnPress,this);}else{this._oTable=G.createTable(this.getId()+"-innerTable",{enableBusyIndicator:true,enableColumnReordering:false,threshold:p1,cellClick:[this._onCellClick,this],noData:this._getNoDataText(),extension:[this._oToolbar],ariaLabelledBy:[this._oTitle],plugins:[G.createMultiSelectionPlugin(this,[this._onRowSelectionChange,this])],columnSelect:[this._onGridTableColumnPress,this],rowSettingsTemplate:q1});this._sAggregation="rows";}this._updateTypeSettings();this._updateSelectionBehavior();this._updateMultiSelectMode();var r1=new D({sourceAggregation:"columns",targetAggregation:"columns",dropPosition:"Between",enabled:this.getActiveP13nModes().includes(E.Column),drop:[this._onColumnRearrange,this]});r1.bIgnoreMetadataCheck=true;this._oTable.addDragDropConfig(r1);this._oTable.setBusyIndicatorDelay(this.getBusyIndicatorDelay());this._oTable.attachPaste(this._onInnerTablePaste,this);if(this.isFilteringEnabled()){d1(this);}};_.prototype._updateColumnResizer=function(){if(!this._oTable){return;}var p1=this.getEnableColumnResize();var q1=this._bMobileTable?R:G;if(p1){q1.enableColumnResizer(this,this._oTable);}else{q1.disableColumnResizer(this,this._oTable);}};_.prototype._updateSelectionBehavior=function(){var p1=this._bMobileTable?R:G;p1.updateSelection(this);};_.prototype._updateMultiSelectMode=function(){if(this._bMobileTable){R.updateMultiSelectMode(this);}};_.prototype._onColumnRearrange=function(p1){var q1=p1.getParameter("draggedControl");var r1=p1.getParameter("droppedControl");if(q1===r1){return;}var s1=p1.getParameter("dropPosition");var t1=this._oTable.indexOfColumn(q1);var u1=this._oTable.indexOfColumn(r1);var v1=u1+(s1=="Before"?0:1)+(t1<u1?-1:0);T.moveColumn(this,t1,v1);};_.prototype._onColumnPress=function(p1){if(this._bSuppressOpenMenu){return;}var q1=p1.getParent(),r1=q1.indexOfColumn(p1),s1=this.getColumns()[r1];this._fullyInitialized().then(function(){if(this._bUseColumnMenu){if(!this._oColumnHeaderMenu){this._oQuickActionContainer=new Q({table:this});this._oItemContainer=new x({table:this});this._oColumnHeaderMenu=new f({_quickActions:[this._oQuickActionContainer],_items:[this._oItemContainer]});}this._oQuickActionContainer.setAssociation("column",s1);Promise.all([this._oQuickActionContainer.initializeQuickActions(),this._oItemContainer.initializeItems()]).then(function(){if(this._oQuickActionContainer.hasQuickActions()||this._oItemContainer.hasItems()){this._oColumnHeaderMenu.openBy(p1);}}.bind(this));}else{var t1=g.getLibraryResourceBundle("sap.ui.mdc"),u1=this._bMobileTable&&this.getEnableColumnResize();if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}if(this.isSortingEnabled()){var v1=[],w1=[];var x1=this.getPropertyHelper().getProperty(s1.getDataProperty()).getSortableProperties();x1.forEach(function(D1){v1.push(new I({text:D1.label,key:D1.name}));w1.push(new I({text:D1.label,key:D1.name}));});if(v1.length>0){this._oPopover=new c({items:[new d({items:v1,label:t1.getText("table.SETTINGS_ASCENDING"),icon:"sap-icon://sort-ascending",action:[X.Ascending,this._onCustomSort,this]}),new d({items:w1,label:t1.getText("table.SETTINGS_DESCENDING"),icon:"sap-icon://sort-descending",action:[X.Descending,this._onCustomSort,this]})]});p1.addDependent(this._oPopover);}}var y1=[];var z1=this.getControlDelegate();var A1=(z1.addColumnMenuItems&&z1.addColumnMenuItems(this,s1))||[];this.getPropertyHelper().getFilterableProperties(s1.getDataProperty()).forEach(function(D1){y1.push(new I({text:D1.label,key:D1.name}));});if(this.isFilteringEnabled()&&y1.length){var B1=new d({label:t1.getText("table.SETTINGS_FILTER"),icon:"sap-icon://filter",action:[o1,this]});A1.unshift(B1);}if(u1){var C1=R.startColumnResize(this._oTable,p1);C1&&A1.push(C1);}A1.forEach(function(D1){this._createPopover(D1,p1);},this);this._oPopover&&this._oPopover.openBy(p1);}}.bind(this));};_.prototype._createPopover=function(p1,q1){if(this._oPopover){this._oPopover.addItem(p1);}else{this._oPopover=new c({items:p1});q1.addDependent(this._oPopover);}};_.prototype._onCustomSort=function(p1,q1){var r1=p1.getParameter("property");this.getCurrentState().sorters.forEach(function(s1){if(s1.name===r1){if(s1.descending&&q1===X.Descending||!s1.descending&&q1===X.Ascending){q1=X.None;}}});T.createSort(this,r1,q1,true);};_.prototype._onColumnResize=function(p1){var q1=p1.getParameter("column");var r1=p1.getParameter("width");var s1=this._oTable.indexOfColumn(q1);var t1=this.getColumns()[s1];var u1=t1.getDataProperty();T.createColumnWidth(this,u1,r1);};_.prototype._onCustomGroup=function(p1){T.createGroup(this,p1);};_.prototype._onCustomAggregate=function(p1){T.createAggregation(this,p1);};_.prototype._insertInnerColumn=function(p1,q1){if(!this._oTable){return;}var r1=p1.getInnerColumn();this._setMobileColumnTemplate(p1,q1);this._bForceRebind=true;if(q1===undefined){this._oTable.addColumn(r1);}else{this._oTable.insertColumn(r1,q1);}};_.prototype._orderColumns=function(){var p1,q1=[],r1=this.getColumns();r1.forEach(function(s1){p1=s1.getInitialIndex();if(p1>-1){q1.push({index:p1,column:this.removeColumn(s1)});}},this);q1.sort(function(s1,t1){return s1-t1;});q1.forEach(function(s1){this.insertColumn(s1.column,s1.index);},this);};_.prototype.moveColumn=function(p1,q1){p1._bIsBeingMoved=true;this.removeAggregation("columns",p1,true);this.insertAggregation("columns",p1,q1,true);delete p1._bIsBeingMoved;if(this._oTable){var r1=p1.getInnerColumn();this._oTable.removeColumn(r1);this._oTable.insertColumn(r1,q1);this._setMobileColumnOrder();this._updateMobileColumnTemplate(p1,q1);}};_.prototype.removeColumn=function(p1){p1=this.removeAggregation("columns",p1,true);this._updateMobileColumnTemplate(p1,-1);return p1;};_.prototype.addColumn=function(p1){this.addAggregation("columns",p1,true);this._insertInnerColumn(p1);return this;};_.prototype.insertColumn=function(p1,q1){this.insertAggregation("columns",p1,q1,true);this._insertInnerColumn(p1,q1);return this;};_.prototype._setMobileColumnTemplate=function(p1,q1){if(!this._bMobileTable){return;}var r1=p1.getTemplateClone();if(q1>=0){this._oTemplate.insertCell(r1,q1);this._oTable.getItems().forEach(function(s1){if(s1.isA("sap.m.GroupHeaderListItem")){return;}s1.insertAggregation("cells",new n(),q1,true);});}else{this._oTemplate.addCell(r1);}};_.prototype._updateMobileColumnTemplate=function(p1,q1){if(!this._bMobileTable){return;}var r1,s1;if(this._oTemplate){r1=p1.getTemplateClone();s1=this._oTemplate.indexOfCell(r1);m1(this._oTemplate,s1,q1);}if(s1>-1){this._oTable.getItems().forEach(function(t1){if(t1.removeCell){m1(t1,s1,q1);}});}};_.prototype._setMobileColumnOrder=function(){if(!this._bMobileTable){return;}this.getColumns().forEach(function(p1){var q1=p1.getInnerColumn();if(!q1){return;}q1.setOrder(this.indexOfColumn(p1));},this);this._oTable.invalidate();};function m1(p1,q1,r1){var s1=p1.removeCell(q1);if(s1){if(r1>-1){p1.insertCell(s1,r1);}else{s1.destroy();}}}_.prototype._onItemPress=function(p1){this.fireRowPress({bindingContext:p1.getParameter("listItem").getBindingContext()});R._onRowActionPress.apply(this,[p1]);};_.prototype._onSelectionChange=function(p1){var q1=p1.getParameter("selectAll");this.fireSelectionChange({bindingContext:p1.getParameter("listItem").getBindingContext(),selected:p1.getParameter("selected"),selectAll:q1});if(q1){var r1=this.getRowBinding();if(r1&&this._oTable){var s1=r1.getLength();var t1=this._oTable.getItems().length;var u1=r1.isLengthFinal();if(t1!=s1||!u1){$("table.SELECTION_LIMIT_MESSAGE",[t1]);}}}};_.prototype._onResponsiveTableColumnPress=function(p1){this._onColumnPress(p1.getParameter("column"));};_.prototype._onCellClick=function(p1){this.fireRowPress({bindingContext:p1.getParameter("rowBindingContext")});};_.prototype._onRowSelectionChange=function(p1){if(!this._bSelectionChangedByAPI){this.fireSelectionChange({bindingContext:p1.getParameter("rowContext"),selected:p1.getSource().isIndexSelected(p1.getParameter("rowIndex")),selectAll:p1.getParameter("selectAll")});}};_.prototype._onGridTableColumnPress=function(p1){p1.preventDefault();this._onColumnPress(p1.getParameter("column"));};_.prototype.getSelectedContexts=function(){if(this._oTable){if(this._bMobileTable){return this._oTable.getSelectedContexts();}var p1=this._oTable.getPlugins()[0].getSelectedIndices();return p1.map(function(q1){return this._oTable.getContextByIndex(q1);},this);}return[];};_.prototype.clearSelection=function(){if(this._oTable){if(this._bMobileTable){this._oTable.removeSelections(true);}else{this._bSelectionChangedByAPI=true;this._oTable.getPlugins()[0].clearSelection();this._bSelectionChangedByAPI=false;}}};_.prototype._registerInnerFilter=function(p1){p1.attachSearch(function(){this._rebind();},this);};_.prototype.isTableBound=function(){return this._oTable?this._oTable.isBound(this._bMobileTable?"items":"rows"):false;};_.prototype.bindRows=function(){if(!this.bDelegateInitialized||!this._oTable){return;}var p1={};this.getControlDelegate().updateBindingInfo(this,p1);if(p1.path){this._oTable.setShowOverlay(false);if(this._bMobileTable&&this._oTemplate){p1.template=this._oTemplate;}else{delete p1.template;}_._addBindingListener(p1,"dataRequested",this._onDataRequested.bind(this));_._addBindingListener(p1,"dataReceived",this._onDataReceived.bind(this));_._addBindingListener(p1,"change",this._onBindingChange.bind(this));this._updateColumnsBeforeBinding();this.getControlDelegate().updateBinding(this,p1,this._bForceRebind?null:this.getRowBinding());this._updateInnerTableNoDataText();this._bForceRebind=false;}};_.prototype._onDataRequested=function(){this._bIgnoreChange=true;};_.prototype._onDataReceived=function(){this._bIgnoreChange=false;this._updateHeaderText();this._updateExportState();};_.prototype._onBindingChange=function(){if(this._bIgnoreChange){return;}this._updateHeaderText();};_.prototype._updateHeaderText=function(){var p1,q1;if(!this._oNumberFormatInstance){this._oNumberFormatInstance=N.getFloatInstance();}if(this._oTitle&&this.getHeader()){p1=this.getHeader();if(this.getShowRowCount()){q1=this._getRowCount(true);if(q1>0){var r1=this._oNumberFormatInstance.format(q1);p1+=" ("+r1+")";}}this._oTitle.setText(p1);}if(!this._bIgnoreChange&&this._bAnnounceTableUpdate){this._bAnnounceTableUpdate=false;this._announceTableUpdate(q1);}};_.prototype._announceTableUpdate=function(p1){var q1=m.getInstance();if(q1){var r1=g.getLibraryResourceBundle("sap.ui.mdc");var s1=this.getHeader();if(p1===undefined&&this._getRowCount(false)>0){q1.announce(r1.getText("table.ANNOUNCEMENT_TABLE_UPDATED",[s1]));}else if(p1>1){q1.announce(r1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_MULT",[s1,p1]));}else if(p1===1){q1.announce(r1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_SING",[s1,p1]));}else{q1.announce(r1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[s1]));}}};_.prototype._updateColumnsBeforeBinding=function(){var p1=this.getColumns();var q1=this.getPropertyHelper();p1.forEach(function(r1){var s1=r1.getInnerColumn();var t1=q1.getProperty(r1.getDataProperty());var u1=t1?t1.getSortableProperties().map(function(t1){return t1.name;}):[];var v1=this._getSortedProperties().find(function(v1){return u1.includes(v1.name);});var w1=v1&&v1.descending?X.Descending:X.Ascending;if(this._bMobileTable){s1.setSortIndicator(v1?w1:X.None);}else{s1.setSorted(!!v1).setSortOrder(w1);}},this);};_.prototype._getRowCount=function(p1){var q1=this._getRowBinding();if(!q1){return p1?undefined:0;}var r1;if(!p1){r1=q1.getLength();}else if(typeof q1.getCount==='function'){r1=q1.getCount();}else if(q1.isLengthFinal()){r1=q1.getLength();}if(r1<0||r1==="0"){r1=0;}return r1;};_.prototype.getRowBinding=function(){return this._getRowBinding();};_.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation);}};_._addBindingListener=function(p1,q1,r1){if(!p1.events){p1.events={};}if(!p1.events[q1]){p1.events[q1]=r1;}else{var s1=p1.events[q1];p1.events[q1]=function(){r1.apply(this,arguments);s1.apply(this,arguments);};}};_.prototype._rebind=function(){if(this._bFullyInitialized){this.bindRows();}else{this._fullyInitialized().then(this._rebind.bind(this));}};function n1(p1){T.showPanel(this,"Columns",p1.getSource());}function o1(p1){T.showPanel(this,"Filter",p1.getSource());}_.prototype._getSorters=function(){var p1=this.getSortConditions()?this.getSortConditions().sorters:[];var q1=[],r1=this.getPropertyHelper();p1.forEach(function(s1){if(r1.hasProperty(s1.name)){var t1=r1.getProperty(s1.name).path;q1.push(new S(t1,s1.descending));}});return q1;};_.prototype._onInnerTablePaste=function(p1){if(!this.getEnablePaste()){return;}this.firePaste({data:p1.getParameter("data")});};_.prototype.exit=function(){if(this._oTemplate){this._oTemplate.destroy();}this._oTemplate=null;this._oTable=null;if(this._oToolbar&&!this._bTableExists){this._oToolbar.destroy();}this._oToolbar=null;this._oTitle=null;this._oNumberFormatInstance=null;a1.forEach(function(p1){var q1=i(p1),r1="_o"+q1;this[r1]=null;},this);this._oTableReady=null;this._oFullInitialize=null;this._oPasteButton=null;if(this._oFilterInfoBarInvisibleText){this._oFilterInfoBarInvisibleText.destroy();this._oFilterInfoBarInvisibleText=null;}C.prototype.exit.apply(this,arguments);};_.prototype.addAction=function(p1){if(p1.getMetadata().getName()!=="sap.ui.mdc.actiontoolbar.ActionToolbarAction"){p1=new u(p1.getId()+"-action",{action:p1});}return C.prototype.addAggregation.apply(this,["actions",p1]);};return _;});
